Dashboard=function(){var t={currencies:ko.observableArray([]),lastUpdateTime:ko.observable(),modalBoxTitle:ko.observable()},e=function(t){return t<10?"0"+t:t},a=function(){var a=new WebSocket("ws://webtask.future-processing.com:8068/ws/currencies");a.onmessage=function(a){var o=JSON.parse(a.data),n=new Date(o.PublicationDate),r=[];o.Items.forEach(function(t){t.SellPrice=parseFloat(t.SellPrice).toFixed(2),t.UnitPrice=parseFloat(t.PurchasePrice).toFixed(2),t.PurchasePrice=parseFloat(t.PurchasePrice*t.Unit).toFixed(2),t.AvailableInWallet=$("[data-currency="+t.Code.toLowerCase()+"]").text(),r.push(t)}),t.currencies(r),t.lastUpdateTime(e(n.getHours())+":"+e(n.getMinutes())+":"+e(n.getSeconds())),$('[data-toggle="tooltip"]').tooltip()},ko.applyBindings(t,document.getElementsByClassName("dashboard")[0])},o=function(){$("body").on("click",'[data-openModalBox="modalBox"]',function(){ModalBox.open($(this)),$("body").on("change","#amount",function(){var t=$(this),e=(t.val()*($("#unitPrice").val()/t.attr("step"))).toFixed(2);$("#total").val(e)})})},n=function(){$("#modalBox").on("submit","form",function(){var t=$("#currency").val(),e=$("#amount").val(),a=$("#total").val();if(!confirm("Are you sure you want to buy "+e+" "+t+" and pay "+a+" PLN?"))return!1;var o=$(this),n=o.find("button[type=submit]"),r=n.text();return n.text("Wait..."),$.ajax({url:o.attr("action"),type:o.attr("method"),data:o.serialize()}).done(function(t){var e=JSON.parse(t);"undefined"!=typeof e.message&&e.message.length>0&&(Toasters.create(e.message),ModalBox.close()),n.text(r),e.success===!0&&location.reload()}),!1})},r=function(){a(),o(),n()};return{init:r}}(),Forms=function(){var t=function(t,e){t.on("submit",function(){var t=$(this),a=t.find("button"),o=a.text();return t.find("button").text("Wait..."),$.ajax({url:t.attr("action"),type:t.attr("method"),data:t.serialize()}).done(function(a){var n=JSON.parse(a);Toasters.create(n.message),t.find("button").text(o),null!==e&&e(n)}),!1})};return{initAjaxSubmit:t}}(),ModalBox=function(){var t=$("#modalBox"),e=$(".dashboard"),a=function(a){var o=a.attr("data-modalBoxUrl"),n=a.attr("data-modalBoxUrlParam");$.ajax({url:o+(n||"")}).done(function(a){t.modal("show"),e.css({filter:"blur(5px)"}),t.find(".modal-content").html(a)}),t.on("hidden.bs.modal",function(){e.css({filter:"blur(0)"})})},o=function(){t.modal("hide")};return{open:a,close:o}}(),Toasters=function(){var t,e=$("body"),a=function(e){o(),$('<div class="toaster">'+e+"</div>").appendTo("body").animate({top:"25px"},250),t=setTimeout(function(){o()},7e3)},o=function(){"undefined"!=typeof t&&clearTimeout(t),e.find(".toaster").animate({top:"-250px"},250,function(){$(this).remove()})};return{create:a}}();